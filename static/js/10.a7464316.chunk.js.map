{"version":3,"sources":["pages/TradeQuery/index.tsx"],"names":["FormItem","Item","Option","RangePicker","WrappedSearchForm","create","observer","props","form","getFieldDecorator","validateFields","loading","useContext","stores","layout","onSubmit","ev","preventDefault","err","values","label","initialValue","style","width","allowClear","value","showTime","format","placeholder","type","htmlType","columns","title","dataIndex","key","align","render","status","ORDER_STATUS_MAP","openLoading","closeLoading","state","useLocalStore","data","pagination","useEffect","query","params","axios","get","results","then","total","background","padding","dashed","rowKey","dataSource","onChange","filters","sorter","pager","current","pageSize"],"mappings":"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","file":"static/js/10.a7464316.chunk.js","sourcesContent":["import React, { useContext, useEffect } from 'react'\nimport { Form, Input, Button, DatePicker, Select, Table, Badge, Divider } from 'antd'\nimport { FormComponentProps } from 'antd/lib/form'\nimport { ColumnProps } from 'antd/lib/table'\nimport { observer, useLocalStore } from 'mobx-react-lite'\nimport * as stores from '../../store'\nimport axios from '../../common/axios'\nimport { ORDER_STATUS_MAP } from '../../common/const'\n\nconst FormItem = Form.Item\nconst Option = Select.Option\nconst { RangePicker } = DatePicker\n\n/*---------- 子组件区域 ----------*/\n\ninterface ISearchFormProps extends FormComponentProps {\n  onSubmit: (params: any) => any\n}\n\nconst SearchForm: React.FC<ISearchFormProps> = props => {\n  const { getFieldDecorator, validateFields } = props.form\n  const { loading } = useContext(stores.uiStore)\n  const handleSubmit = (ev: React.FormEvent<HTMLFormElement>) => {\n    ev.preventDefault()\n    validateFields((err, values) => {\n      if (!err) {\n        props.onSubmit(values)\n      }\n    })\n  }\n\n  return (\n    <Form layout=\"inline\" onSubmit={handleSubmit}>\n      <FormItem label=\"产品名称\">\n        {getFieldDecorator('productCode', {\n          initialValue: '0'\n        })(\n          <Select style={{ width: 120 }} allowClear>\n            <Option value=\"0\">全部</Option>\n            <Option value=\"1\">product-1</Option>\n            <Option value=\"2\">product-2</Option>\n            <Option value=\"3\">product-3</Option>\n          </Select>\n        )}\n      </FormItem>\n      <FormItem label=\"合作商订单号\">{getFieldDecorator('merOrderNo')(<Input />)}</FormItem>\n      <FormItem label=\"本地订单号\">{getFieldDecorator('payOrderId')(<Input />)}</FormItem>\n      <FormItem label=\"商户编号\">{getFieldDecorator('roadCode')(<Input />)}</FormItem>\n      <FormItem label=\"商户名称\">{getFieldDecorator('merName')(<Input />)}</FormItem>\n      <FormItem label=\"交易时间\">\n        {getFieldDecorator('datetime')(\n          <RangePicker\n            showTime={{ format: 'HH:mm' }}\n            format=\"YYYY-MM-DD HH:mm\"\n            placeholder={['', '']}\n          />\n        )}\n      </FormItem>\n      <FormItem>\n        <Button loading={loading} type=\"primary\" htmlType=\"submit\">\n          查询\n        </Button>\n      </FormItem>\n    </Form>\n  )\n}\n\nconst WrappedSearchForm = Form.create<ISearchFormProps>()(observer(SearchForm))\n\n/*---------- 父组件区域 ----------*/\n\nconst columns: ColumnProps<unknown>[] = [\n  {\n    title: '合作商订单号',\n    dataIndex: 'merOrderNo',\n    key: 'merOrderNo'\n  },\n  {\n    title: '本地订单号',\n    dataIndex: 'payOrderId',\n    key: 'payOrderId'\n  },\n  {\n    title: '商户编号',\n    dataIndex: 'roadCode',\n    key: 'roadCode'\n  },\n  {\n    title: '商户名称',\n    dataIndex: 'merName',\n    key: 'merName'\n  },\n  {\n    title: '交易金额（元）',\n    dataIndex: 'amount',\n    align: 'right',\n    width: 140,\n    key: 'amount'\n  },\n  {\n    title: '交易时间',\n    dataIndex: 'createTime',\n    align: 'center',\n    key: 'createTime'\n  },\n  {\n    title: '交易状态',\n    dataIndex: 'status',\n    align: 'left',\n    render: (status: number) => {\n      return (\n        <div>\n          <Badge\n            status={\n              ({\n                10: 'default',\n                20: 'warning',\n                30: 'processing',\n                40: 'error',\n                50: 'success'\n              } as Record<number, any>)[status]\n            }\n          />\n          {ORDER_STATUS_MAP[status]}\n        </div>\n      )\n    },\n    key: 'status'\n  }\n]\n\ninterface ITradeQueryState {\n  data: any\n  pagination: any\n}\n\nconst TradeQuery: React.FC = props => {\n  const { loading, openLoading, closeLoading } = useContext(stores.uiStore)\n  const state = useLocalStore(\n    () =>\n      ({\n        data: [],\n        pagination: {}\n      } as ITradeQueryState)\n  )\n\n  useEffect(() => {\n    query()\n    // eslint-disable-next-line\n  }, [])\n\n  const handleTableChange = (pagination: any, filters: any, sorter: any) => {\n    let pager = { ...state.pagination }\n    pager.current = pagination.current\n    state.pagination = pager\n    query({\n      results: pagination.pageSize\n    })\n  }\n\n  const query = (params = {}) => {\n    openLoading()\n    axios\n      .get('/trade-query', {\n        params: {\n          results: 10,\n          ...params\n        }\n      })\n      .then(data => {\n        const pagination = { ...state.pagination }\n        pagination.total = 200\n        state.data = data\n        state.pagination = pagination\n        closeLoading()\n      })\n  }\n\n  return (\n    <div style={{ background: '#fff', padding: '24px' }}>\n      <WrappedSearchForm onSubmit={query} />\n      <Divider dashed />\n      <Table\n        loading={loading}\n        columns={columns}\n        rowKey=\"id\"\n        dataSource={state.data}\n        pagination={state.pagination}\n        onChange={handleTableChange}\n      />\n    </div>\n  )\n}\n\nexport default observer(TradeQuery)\n"],"sourceRoot":""}